"use client";

import { XMarkIcon } from "@heroicons/react/24/outline";
import Image from "next/image";
import { FC, useState, useEffect } from "react";

type SelectedColourSwatchProps = {
  name: string;
  image: string;
  active: boolean;
  color: "white" | "black";
};

const SelectedColourSwatch: FC<SelectedColourSwatchProps> = ({
  name,
  image,
  color,
  active,
}) => {
  const [isModalOpen, setIsModalOpen] = useState(false);

  // Prevent body scroll when modal is open
  useEffect(() => {
    if (isModalOpen) {
      document.body.style.overflow = "hidden";
    } else {
      document.body.style.overflow = "unset";
    }

    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === "Escape") setIsModalOpen(false);
    };

    if (isModalOpen) {
      document.addEventListener("keydown", handleEscape);
    }

    return () => {
      document.body.style.overflow = "unset";
      document.removeEventListener("keydown", handleEscape);
    };
  }, [isModalOpen]);
  return (
    <div className="relative">
      <div className="relative w-full aspect-square overflow-hidden flex items-center justify-center h-64 md:h-80 lg:h-96 xl:h-[28rem] 2xl:h-[32rem] rounded-lg border border-gray-200 shadow-sm">
        <Image
          src={image}
          alt={name}
          width={500}
          height={500}
          className="object-cover w-full h-full"
        />
      </div>
      <div className="absolute right-0 top-0 p-3 flex flex-col gap-3 items-center justify-center">
        <button
          type="button"
          onClick={() => setIsModalOpen(true)}
          className="bg-white/90 backdrop-blur-sm rounded-full p-2 hover:bg-white hover:scale-110 transition-all duration-200 shadow-md"
          aria-label="Enlarge image"
        >
          <svg
            width="24"
            height="24"
            viewBox="0 0 38 36"
            fill="#000000"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M2.69427 4.59122C2.69427 4.98867 2.69427 5.23536 2.69427 5.49576C2.69427 6.83886 2.69427 8.19566 2.69427 9.53876C2.69427 10.32 2.12244 10.8819 1.37361 10.8956C0.611166 10.8956 0.0529476 10.3748 0.0121023 9.57988C-0.0151279 9.07279 0.0121023 8.57941 0.0121023 8.07232C0.0121023 5.90691 0.0121023 3.7415 0.0121023 1.58979C0.0121023 0.507088 0.515859 0 1.57784 0C4.19193 0 6.80603 0 9.40652 0C10.1417 0 10.6727 0.424859 10.8225 1.11011C10.945 1.69943 10.6183 2.35728 10.0464 2.59027C9.78774 2.69991 9.47459 2.72732 9.18867 2.72732C7.92247 2.74102 4.791 2.72732 4.791 2.72732C4.791 2.72732 9.58351 7.62005 11.7755 9.82657C12.2112 10.2651 12.5108 10.7311 12.3065 11.389C12.0342 12.2935 10.9995 12.6635 10.237 12.1153C10.06 11.992 9.89666 11.8275 9.74689 11.6631C7.43233 9.33319 5.13138 7.01702 2.72151 4.57751L2.69427 4.59122Z"
              fill="#000000"
            />
            <path
              d="M33.4088 2.69427C33.0113 2.69427 32.7646 2.69427 32.5042 2.69427C31.1611 2.69427 29.8043 2.69427 28.4612 2.69427C27.68 2.69427 27.1181 2.12244 27.1044 1.37361C27.1044 0.611166 27.6252 0.0529471 28.4201 0.0121019C28.9272 -0.0151283 29.4206 0.0121019 29.9277 0.012102C32.0931 0.012102 34.2585 0.0121021 36.4102 0.0121022C37.4929 0.0121023 38 0.515859 38 1.57784C38 4.19193 38 6.80603 38 9.40652C38 10.1417 37.5751 10.6727 36.8899 10.8225C36.3006 10.945 35.6427 10.6183 35.4097 10.0464C35.3001 9.78774 35.2727 9.47459 35.2727 9.18868C35.259 7.92247 35.2727 4.791 35.2727 4.791C35.2727 4.791 30.38 9.58351 28.1734 11.7755C27.7349 12.2112 27.2689 12.5108 26.611 12.3065C25.7065 12.0342 25.3365 10.9995 25.8847 10.237C26.008 10.06 26.1725 9.89666 26.3369 9.74689C28.6668 7.43233 30.983 5.13138 33.4225 2.72151L33.4088 2.69427Z"
              fill="#000000"
            />
            <path
              d="M35.3057 30.7576C35.3057 30.3601 35.3057 30.1135 35.3057 29.8531C35.3057 28.51 35.3057 27.1532 35.3057 25.8101C35.3057 25.0289 35.8776 24.4669 36.6264 24.4532C37.3888 24.4532 37.9471 24.974 37.9879 25.7689C38.0151 26.276 37.9879 26.7694 37.9879 27.2765C37.9879 29.4419 37.9879 31.6073 37.9879 33.759C37.9879 34.8417 37.4841 35.3488 36.4222 35.3488C33.8081 35.3488 31.194 35.3488 28.5935 35.3488C27.8583 35.3488 27.3273 34.924 27.1775 34.2387C27.055 33.6494 27.3817 32.9915 27.9536 32.7585C28.2123 32.6489 28.5254 32.6215 28.8113 32.6215C30.0775 32.6078 33.209 32.6215 33.209 32.6215C33.209 32.6215 28.4165 27.7288 26.2245 25.5222C25.7888 25.0837 25.4892 24.6177 25.6935 23.9599C25.9658 23.0553 27.0005 22.6853 27.763 23.2335C27.94 23.3568 28.1033 23.5213 28.2531 23.6858C30.5677 26.0156 32.8686 28.3318 35.2785 30.7713L35.3057 30.7576Z"
              fill="#000000"
            />
            <path
              d="M4.59122 32.6545C4.98867 32.6545 5.23536 32.6545 5.49576 32.6545C6.83886 32.6545 8.19566 32.6545 9.53876 32.6545C10.32 32.6545 10.8819 33.2264 10.8956 33.9752C10.8956 34.7376 10.3748 35.2959 9.57988 35.3367C9.07279 35.3639 8.57941 35.3367 8.07232 35.3367C5.90691 35.3367 3.7415 35.3367 1.58979 35.3367C0.507088 35.3367 6.15156e-09 34.833 1.88155e-08 33.771C4.99883e-08 31.1569 8.11611e-08 28.5428 1.12172e-07 25.9423C1.20939e-07 25.2071 0.424859 24.6761 1.11011 24.5263C1.69943 24.4038 2.35728 24.7306 2.59027 25.3024C2.69991 25.5611 2.72732 25.8742 2.72732 26.1601C2.74102 27.4263 2.72732 30.5578 2.72732 30.5578C2.72732 30.5578 7.62005 25.7653 9.82657 23.5733C10.2651 23.1376 10.7311 22.8381 11.389 23.0423C12.2935 23.3146 12.6635 24.3493 12.1153 25.1118C11.992 25.2888 11.8275 25.4522 11.6631 25.6019C9.33319 27.9165 7.01702 30.2174 4.57751 32.6273L4.59122 32.6545Z"
              fill="#000000"
            />
          </svg>
        </button>
        <a
          href={image}
          download={name}
          className="bg-white/90 backdrop-blur-sm rounded-full p-2 hover:bg-white hover:scale-110 transition-all duration-200 shadow-md inline-block"
          aria-label="Download image"
        >
          <svg
            width="24"
            height="24"
            viewBox="0 0 38 38"
            fill="#000000"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M0 2.86655C0 1.87304 0.611608 0.966001 1.5554 0.612409C2.08103 0.414475 2.67896 0.343373 3.35309 0.349138C11.5873 0.412553 19.8216 0.377963 28.0558 0.379885C29.875 0.379885 30.8031 1.27155 30.811 3.06449C30.8246 5.80482 30.8129 8.54515 30.8129 11.2836C30.8129 12.1118 30.5882 12.7921 29.6737 13.063C28.5267 13.4032 27.5751 12.7133 27.5536 11.4219C27.5145 9.19276 27.5399 6.96168 27.538 4.73252C27.538 4.38853 27.538 4.04455 27.538 3.64868H3.36091V27.5737C3.71654 27.5737 4.0624 27.5737 4.40826 27.5737C7.6832 27.5737 10.9562 27.5661 14.2311 27.5776C15.6185 27.5833 16.3004 28.2137 16.1969 29.3628C16.1206 30.2045 15.6654 30.7657 14.7821 30.7714C10.5028 30.7926 6.22355 30.7907 1.9462 30.7657C1.44207 30.7618 1.06494 30.5754 0.760113 30.291C0.254022 29.824 0 29.1514 0 28.4692V2.86655Z"
              fill="#000000"
            />
            <path
              d="M20.5974 36.4366C20.3512 36.1484 20.2007 35.7909 20.2515 35.2798C20.3336 34.4592 21.0664 33.85 21.9046 33.8462C26.8034 33.827 31.7021 33.8347 36.5989 33.8404C37.3355 33.8404 37.9999 34.5149 37.9999 35.4585C37.9999 36.8075 37.3824 37.0823 36.9623 37.0823H22.0746C21.5119 37.0823 20.9589 36.8594 20.5954 36.4366H20.5974Z"
              fill="#000000"
            />
            <path
              d="M30.868 26.8571C31.3546 26.4016 31.6672 26.0826 32.0092 25.7963C32.697 25.2236 33.5822 25.2563 34.1977 25.8559C34.8112 26.4535 34.9011 27.3778 34.2778 28.0005C32.9608 29.3168 31.6008 30.5947 30.2213 31.8496C29.5569 32.4549 28.7792 32.4396 28.1168 31.8362C26.7626 30.6024 25.4261 29.3476 24.1247 28.0581C23.4564 27.3971 23.5229 26.4612 24.1755 25.8405C24.7969 25.2505 25.6762 25.2294 26.366 25.8097C26.706 26.0961 27.0186 26.4151 27.5403 26.9032C27.5403 26.3497 27.5403 26.0192 27.5403 25.6868C27.5403 23.3923 27.5149 21.0997 27.556 18.8071C27.5794 17.4196 28.7479 16.6894 29.9438 17.2486C30.7137 17.608 30.8172 18.2902 30.8172 19.0204C30.8172 21.2496 30.8172 23.4806 30.8192 25.7098C30.8192 26.0192 30.8446 26.3305 30.868 26.8571Z"
              fill="#000000"
            />
            <path
              d="M21.69 16.7624C20.5781 17.8885 19.6148 18.8628 18.5948 19.8967C18.841 20.1887 19.2318 20.5135 19.4233 20.9286C19.4467 20.9805 19.4643 21.0362 19.4761 21.0919C19.5835 21.6319 19.1009 22.1335 18.544 22.0701C18.4346 22.0586 18.3408 22.0278 18.2743 21.9702C17.2504 21.0477 16.3184 20.0273 15.5661 19.2587C13.5769 21.0727 11.6932 22.8176 9.77044 24.5202C9.25068 24.9814 8.44171 25.458 7.91999 24.7335C7.78712 24.5491 7.80666 24.2992 7.90827 24.0975C8.0939 23.7266 8.42608 23.4422 8.72114 23.1443C10.4622 21.3898 12.2071 19.6372 13.952 17.8846C15.0482 16.7835 15.4097 16.7777 16.4884 17.8443C16.7776 18.1306 16.9515 18.2901 17.3208 18.711C18.5889 17.4561 19.6402 16.4818 20.6993 15.3422C21.346 14.6447 21.8013 14.6831 22.4227 15.3634C23.2649 16.2858 24.1911 17.1371 25.0899 18.0096C25.5062 18.4131 25.7445 18.8647 25.2697 19.3278C24.7929 19.7948 24.322 19.5546 23.9273 19.1395C23.1789 18.3516 22.4364 17.556 21.688 16.7605L21.69 16.7624Z"
              fill="#000000"
            />
            <path
              d="M10.5268 14.7101C8.26401 14.7101 6.45459 12.9421 6.45264 10.7283C6.45264 8.53568 8.29137 6.7216 10.5248 6.71583C12.7758 6.71007 14.5872 8.49148 14.5872 10.7091C14.5872 12.9056 12.7583 14.7081 10.5268 14.7101ZM10.4975 8.38194C9.18045 8.39731 8.12137 9.48307 8.14872 10.7879C8.17413 12.0485 9.2332 13.0689 10.5248 13.0786C11.8438 13.0882 12.9341 12.0159 12.9283 10.7149C12.9224 9.41197 11.832 8.36465 10.4994 8.38194H10.4975Z"
              fill="#000000"
            />
          </svg>
          {/* <Image
            src={downloadSvg}
            alt="download"
            width={50}
            height={50}
            className="object-cover w-10 h-10"
          /> */}
        </a>
      </div>

      {/* Custom Modal */}
      {isModalOpen && (
        <>
          {/* Backdrop */}
          <div
            className="fixed inset-0 bg-black/80 z-50 transition-opacity duration-300"
            onClick={() => setIsModalOpen(false)}
            aria-hidden="true"
          />

          {/* Modal Content */}
          <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
            <div
              className="bg-white rounded-xl max-w-3xl w-full max-h-[85vh] flex flex-col shadow-2xl transform transition-all duration-300"
              onClick={(e) => e.stopPropagation()}
            >
              {/* Header */}
              <div className="bg-gradient-to-r from-gray-50 to-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-xl flex-shrink-0">
                <h3 className="text-xl font-semibold text-gray-900">{name}</h3>
                <button
                  type="button"
                  onClick={() => setIsModalOpen(false)}
                  className="rounded-full p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-200 transition-all duration-200"
                  aria-label="Close modal"
                >
                  <XMarkIcon className="h-5 w-5" aria-hidden="true" />
                </button>
              </div>

              {/* Image Container */}
              <div className="flex-1 flex items-center justify-center p-8 overflow-hidden bg-gray-50">
                <Image
                  src={image}
                  alt={name}
                  width={1200}
                  height={1200}
                  className="max-w-full max-h-full w-auto h-auto object-contain rounded-lg shadow-sm"
                />
              </div>
            </div>
          </div>
        </>
      )}
    </div>
  );
};

export default SelectedColourSwatch;
